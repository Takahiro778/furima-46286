<%= render "shared/header" %>

<div class="item-show">
  <div class="item-box">
    <h2 class="name"><%= @item.name %></h2>

    <div class='item-img-content'>
      <% if @item.image.attached? %>
        <%= image_tag @item.image, class: "item-box-img" %>
      <% else %>
        <%= image_tag "placeholder.png", class: "item-box-img", alt: "no image" %>
      <% end %>
    </div>

<div class="item-price-box">
  <span class="item-price"><%= number_to_currency(@item.price, unit: "¥", precision: 0, format: "%u %n") %></span>
  <span class="item-postage">
    <%= @item.shipping_fee_status&.name || "配送料未設定" %>
  </span>
</div>

<%# ▼ 編集 → or → 削除（出品者のみ） %>
<% if user_signed_in? && current_user == @item.user %>
  <%= link_to "商品の編集",
              edit_item_path(@item),
              class: "item-red-btn" %>

  <p class="or-text">or</p>

  <%= link_to "削除",
              item_path(@item),
              class: "item-destroy",
              rel: "nofollow",
              data: { turbo_method: :delete, turbo_confirm: "本当に削除しますか？" } %>

<%# ▼ ログイン済み & 他人の商品なら購入ボタン（任意の遷移先に変更可） %>
<% elsif user_signed_in? %>
  <%= link_to "購入画面に進む", "#", class: "item-red-btn" %>
<% end %>


    <div class="item-explain-box">
      <%= simple_format(@item.info) %>
    </div>

    <table class="detail-table">
      <tbody>
        <tr><th class="detail-item">出品者</th><td class="detail-value"><%= @item.user&.nickname || "不明" %></td></tr>
        <tr><th class="detail-item">カテゴリー</th><td class="detail-value"><%= @item.category&.name || "未設定" %></td></tr>
        <tr><th class="detail-item">商品の状態</th><td class="detail-value"><%= @item.sales_status&.name || "未設定" %></td></tr>
        <tr><th class="detail-item">配送料の負担</th><td class="detail-value"><%= @item.shipping_fee_status&.name || "未設定" %></td></tr>
        <tr><th class="detail-item">発送元の地域</th><td class="detail-value"><%= @item.prefecture&.name || "未設定" %></td></tr>
        <tr><th class="detail-item">発送日の目安</th><td class="detail-value"><%= @item.scheduled_delivery&.name || "未設定" %></td></tr>
      </tbody>
    </table>

    <div class="option">
      <div class="favorite-btn"><span>お気に入り 0</span></div>
      <div class="report-btn"><span>不適切な商品の通報</span></div>
    </div>
  </div>

  <div class="comment-box">
    <form>
      <textarea class="comment-text"></textarea>
      <p class="comment-warn">
        相手のことを考え丁寧なコメントを心がけましょう。<br>
        不快な言葉遣いなどは利用制限や退会処分となることがあります。
      </p>
      <button type="button" class="comment-btn">
        <span>コメントする</span>
      </button>
    </form>
  </div>

  <%# ▼ 復活：前後リンク & カテゴリ誘導（URLは未実装なので # のままでもOK） %>
  <div class="links">
    <a href="#" class="change-item-btn">＜ 前の商品</a>
    <a href="#" class="change-item-btn">後ろの商品 ＞</a>
  </div>
  <a href="#" class='another-item'>
    <%= @item.category&.name || "カテゴリー" %>をもっと見る
  </a>
</div>

<%= render "shared/footer" %>
